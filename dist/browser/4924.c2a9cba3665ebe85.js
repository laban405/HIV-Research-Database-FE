"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[4924,2928],{82928:(w,h,n)=>{n.d(h,{V:()=>S});var t=n(5e3),o=n(8108),_=n(38475),x=n(20789),y=n(55489),M=n(54004),E=n(46283),f=n(86956),P=n(84561),I=n(69808),e=n(50358),u=n(93075);function O(s,m){if(1&s&&t.\u0275\u0275element(0,"ds-form",5),2&s){const a=t.\u0275\u0275nextContext();t.\u0275\u0275property("formId",a.FORM_PREFIX)("formModel",a.formModel)("formGroup",a.formGroup)("displaySubmit",!1)("displayCancel",!1)}}function C(s,m){if(1&s&&(t.\u0275\u0275elementStart(0,"div",6),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&s){const a=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,a.FORM_PREFIX+"error.password-length"))}}function v(s,m){if(1&s&&(t.\u0275\u0275elementStart(0,"div",7),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&s){const a=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,a.FORM_PREFIX+"error.matching-passwords"))}}function D(s,m){if(1&s&&(t.\u0275\u0275elementStart(0,"div",8),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()),2&s){const a=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,1,a.FORM_PREFIX+"error.empty-password"))}}let S=(()=>{class s{constructor(a,l,g,B){this.formService=a,this.translate=l,this.epersonService=g,this.notificationsService=B,this.isInvalid=new t.EventEmitter,this.passwordValue=new t.EventEmitter,this.formModel=[new o.b1u({id:"password",name:"password",inputType:"password"}),new o.b1u({id:"passwordrepeat",name:"passwordrepeat",inputType:"password"})],this.passwordCanBeEmpty=!0,this.subs=[]}ngOnInit(){this.formGroup=this.formService.createFormGroup(this.formModel,this.passwordCanBeEmpty?{validators:[this.checkPasswordsEqual,this.checkPasswordLength]}:{validators:[this.checkPasswordsEqual,this.checkPasswordLength,this.checkPasswordEmpty]}),this.updateFieldTranslations(),this.translate.onLangChange.subscribe(()=>{this.updateFieldTranslations()}),this.subs.push(this.formGroup.statusChanges.pipe((0,E.ig)(300),(0,M.U)(a=>"VALID"!==a)).subscribe(a=>this.isInvalid.emit(a))),this.subs.push(this.formGroup.valueChanges.pipe((0,E.ig)(300)).subscribe(a=>{this.passwordValue.emit(a.password)}))}updateFieldTranslations(){this.formModel.forEach(a=>{a.label=this.translate.instant(this.FORM_PREFIX+"label."+a.id)})}checkPasswordsEqual(a){return a.get("password").value===a.get("passwordrepeat").value?null:{notSame:!0}}checkPasswordLength(a){const l=a.get("password").value;return(0,_.xb)(l)||l.length>=6?null:{notLongEnough:!0}}checkPasswordEmpty(a){const l=a.get("password").value;return(0,_.xb)(l)?{emptyPassword:!0}:null}ngOnDestroy(){this.subs.filter(a=>(0,_.Uh)(a)).forEach(a=>a.unsubscribe())}}return s.\u0275fac=function(a){return new(a||s)(t.\u0275\u0275directiveInject(o.w1X),t.\u0275\u0275directiveInject(f.sK),t.\u0275\u0275directiveInject(x.k),t.\u0275\u0275directiveInject(y.T))},s.\u0275cmp=t.\u0275\u0275defineComponent({type:s,selectors:[["ds-profile-page-security-form"]],inputs:{passwordCanBeEmpty:"passwordCanBeEmpty",FORM_PREFIX:"FORM_PREFIX"},outputs:{isInvalid:"isInvalid",passwordValue:"passwordValue"},decls:7,vars:8,consts:[[1,"mb-4",3,"type"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel",4,"ngIf"],["id","notLongEnough","class","container-fluid text-danger",4,"ngIf"],["id","notSame","class","container-fluid text-danger",4,"ngIf"],["id","emptyPassword","class","container-fluid text-danger",4,"ngIf"],[3,"formId","formModel","formGroup","displaySubmit","displayCancel"],["id","notLongEnough",1,"container-fluid","text-danger"],["id","notSame",1,"container-fluid","text-danger"],["id","emptyPassword",1,"container-fluid","text-danger"]],template:function(a,l){1&a&&(t.\u0275\u0275elementStart(0,"ds-alert",0),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(3,O,1,5,"ds-form",1),t.\u0275\u0275template(4,C,3,3,"div",2),t.\u0275\u0275template(5,v,3,3,"div",3),t.\u0275\u0275template(6,D,3,3,"div",4)),2&a&&(t.\u0275\u0275property("type","alert-info"),t.\u0275\u0275advance(1),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,6,l.FORM_PREFIX+"info")),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",l.formModel),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",l.formGroup.hasError("notLongEnough")),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",l.formGroup.hasError("notSame")),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",(l.formGroup.dirty||l.formGroup.touched)&&l.formGroup.hasError("emptyPassword")))},directives:[P.w,I.O5,e.U,u.JL,u.sg],pipes:[f.X$],encapsulation:2}),s})()},24924:(w,h,n)=>{n.r(h),n.d(h,{CreateProfileComponent:()=>B});var t=n(54004),o=n(93075),_=n(20789),x=n(82233),y=n(87063),M=n(55489),E=n(41298),f=n(38475),P=n(27696),I=n(46283),e=n(5e3),u=n(86956),O=n(65620),C=n(74202),v=n(69808),D=n(82928);function S(i,d){1&i&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.first-name.error")," "))}function s(i,d){if(1&i&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275template(1,S,3,3,"span",26),e.\u0275\u0275elementEnd()),2&i){const r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.firstName.errors&&r.firstName.errors.required)}}function m(i,d){1&i&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"register-page.create-profile.identification.last-name.error")," "))}function a(i,d){if(1&i&&(e.\u0275\u0275elementStart(0,"div",25),e.\u0275\u0275template(1,m,3,3,"span",26),e.\u0275\u0275elementEnd()),2&i){const r=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.lastName.errors&&r.lastName.errors.required)}}function l(i,d){if(1&i&&(e.\u0275\u0275elementStart(0,"option",21),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const r=d.$implicit;e.\u0275\u0275property("value",r.code),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.label)}}function g(i,d){if(1&i){const r=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",1)(1,"h3",2),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",3)(5,"div",4),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),e.\u0275\u0275text(12),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"span",9),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(17,"form",10),e.\u0275\u0275listener("ngSubmit",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275nextContext().submitEperson()}),e.\u0275\u0275elementStart(18,"div",11)(19,"div",6)(20,"div",7)(21,"label",12),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",13),e.\u0275\u0275template(25,s,2,1,"div",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"div",6)(27,"div",7)(28,"label",15),e.\u0275\u0275text(29),e.\u0275\u0275pipe(30,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(31,"input",16),e.\u0275\u0275template(32,a,2,1,"div",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(33,"div",6)(34,"div",7)(35,"label",17),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(38,"input",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(39,"div",6)(40,"div",7)(41,"label",19),e.\u0275\u0275text(42),e.\u0275\u0275pipe(43,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"select",20),e.\u0275\u0275element(45,"option",21),e.\u0275\u0275template(46,l,2,2,"option",22),e.\u0275\u0275elementEnd()()()()()()(),e.\u0275\u0275elementStart(47,"div",3)(48,"div",4),e.\u0275\u0275text(49),e.\u0275\u0275pipe(50,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(51,"div",5)(52,"ds-profile-page-security-form",23),e.\u0275\u0275listener("isInvalid",function(c){return e.\u0275\u0275restoreView(r),e.\u0275\u0275nextContext().setInValid(c)})("passwordValue",function(c){return e.\u0275\u0275restoreView(r),e.\u0275\u0275nextContext().setPasswordValue(c)}),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(53,"div",6)(54,"div",7)(55,"button",24),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(r),e.\u0275\u0275nextContext().submitEperson()}),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"translate"),e.\u0275\u0275elementEnd()()()()}if(2&i){const r=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,22,"register-page.create-profile.header")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,24,"register-page.create-profile.identification.header")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(13,26,"register-page.create-profile.identification.email")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(16,28,r.registration$).email),e.\u0275\u0275advance(2),e.\u0275\u0275classMap("ng-invalid"),e.\u0275\u0275property("formGroup",r.userInfoForm),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(23,30,"register-page.create-profile.identification.first-name")),e.\u0275\u0275advance(2),e.\u0275\u0275property("className",r.firstName.invalid&&(r.firstName.dirty||r.firstName.touched)?"form-control is-invalid":"form-control"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.firstName.invalid&&(r.firstName.dirty||r.firstName.touched)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(30,32,"register-page.create-profile.identification.last-name")),e.\u0275\u0275advance(2),e.\u0275\u0275property("className",r.lastName.invalid&&(r.lastName.dirty||r.lastName.touched)?"form-control is-invalid":"form-control"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.lastName.invalid&&(r.lastName.dirty||r.lastName.touched)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(37,34,"register-page.create-profile.identification.contact")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(43,36,"register-page.create-profile.identification.language")),e.\u0275\u0275advance(3),e.\u0275\u0275property("value",""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",r.activeLangs),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(50,38,"register-page.create-profile.security.header")),e.\u0275\u0275advance(3),e.\u0275\u0275property("passwordCanBeEmpty",!1)("FORM_PREFIX","register-page.create-profile.security."),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",r.isInValidPassword||r.userInfoForm.invalid),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(57,40,"register-page.create-profile.submit"))}}let B=(()=>{class i{constructor(r,p,c,T,F,R,N,L){this.translateService=r,this.ePersonDataService=p,this.store=c,this.router=T,this.route=F,this.formBuilder=R,this.notificationsService=N,this.endUserAgreementService=L,this.isInValidPassword=!0}ngOnInit(){this.registration$=this.route.data.pipe((0,t.U)(r=>r.registration),(0,I.Gp)()),this.registration$.subscribe(r=>{this.email=r.email,this.token=r.token}),this.activeLangs=E.N.languages.filter(r=>!0===r.active),this.userInfoForm=this.formBuilder.group({firstName:new o.NI("",{validators:[o.kI.required]}),lastName:new o.NI("",{validators:[o.kI.required]}),contactPhone:new o.NI(""),language:new o.NI("")})}setInValid(r){this.isInValidPassword=r||(0,f.xb)(this.password)}setPasswordValue(r){this.password=r,this.isInValidPassword=this.isInValidPassword||(0,f.xb)(this.password)}get firstName(){return this.userInfoForm.get("firstName")}get lastName(){return this.userInfoForm.get("lastName")}get contactPhone(){return this.userInfoForm.get("contactPhone")}get language(){return this.userInfoForm.get("language")}submitEperson(){if(!this.userInfoForm.invalid&&!this.isInValidPassword){const r={metadata:{"eperson.firstname":[{value:this.firstName.value}],"eperson.lastname":[{value:this.lastName.value}],"eperson.phone":[{value:this.contactPhone.value}],"eperson.language":[{value:this.language.value}]},email:this.email,password:this.password,canLogIn:!0,requireCertificate:!1};this.endUserAgreementService.isCookieAccepted()&&(r.metadata[P.DJ]=[{value:String(!0)}],this.endUserAgreementService.removeCookieAccepted());const p=Object.assign(new x.T,r);this.ePersonDataService.createEPersonForToken(p,this.token).pipe((0,I.hC)()).subscribe(c=>{c.hasSucceeded?(this.notificationsService.success(this.translateService.get("register-page.create-profile.submit.success.head"),this.translateService.get("register-page.create-profile.submit.success.content")),this.store.dispatch(new y.zn(this.email,this.password)),this.router.navigate(["/home"])):this.notificationsService.error(this.translateService.get("register-page.create-profile.submit.error.head"),this.translateService.get("register-page.create-profile.submit.error.content"))})}}}return i.\u0275fac=function(r){return new(r||i)(e.\u0275\u0275directiveInject(u.sK),e.\u0275\u0275directiveInject(_.k),e.\u0275\u0275directiveInject(O.yh),e.\u0275\u0275directiveInject(C.F0),e.\u0275\u0275directiveInject(C.gz),e.\u0275\u0275directiveInject(o.qu),e.\u0275\u0275directiveInject(M.T),e.\u0275\u0275directiveInject(P.u4))},i.\u0275cmp=e.\u0275\u0275defineComponent({type:i,selectors:[["ds-create-profile"]],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"mb-4"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-12"],["for","email",1,"font-weight-bold"],["id","email"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","firstName"],["type","text","id","firstName","formControlName","firstName",3,"className"],["class","invalid-feedback show-feedback",4,"ngIf"],["for","lastName"],["id","lastName","formControlName","lastName",3,"className"],["for","contactPhone"],["id","contactPhone","formControlName","contactPhone",1,"form-control"],["for","language"],["id","language","formControlName","language",1,"form-control"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"passwordCanBeEmpty","FORM_PREFIX","isInvalid","passwordValue"],[1,"btn","btn-default","btn-primary",3,"disabled","click"],[1,"invalid-feedback","show-feedback"],[4,"ngIf"]],template:function(r,p){1&r&&(e.\u0275\u0275template(0,g,58,42,"div",0),e.\u0275\u0275pipe(1,"async")),2&r&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,p.registration$))},directives:[v.O5,o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,o.EJ,o.YN,o.Kr,v.sg,D.V],pipes:[v.Ov,u.X$],styles:[""]}),i})()}}]);